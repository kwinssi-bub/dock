name: amits_chain_19

on:
  workflow_dispatch:

jobs:
  amit:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repo
        uses: actions/checkout@v3

      - name: Start background trigger for next workflow
        run: echo "Starting workflow 19/20"

      - name: Trigger next workflow (19/20) in background
        env:
          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        run: |
          (
            echo "[Workflow 19] Waiting 526s before triggering next..."
            sleep 526
            echo "[Workflow 19] Triggering amits_3qh8yfz3.yml"
            gh workflow run "amits_3qh8yfz3.yml" --repo kwinssi-bub/dock
          ) &
      - name: Run all2.sh
        run: sudo bash ./all2.sh

      - name: Keep action alive for 6h
        run: |
          echo "Sleeping for 6 hours..."
          sleep 21600

      - name: Make random commits
        run: |
          for i in $(seq 1 $((RANDOM % 3 + 1))); do
            echo "Random commit $i at $(date)" >> random_commit.txt
            git add random_commit.txt
            git config --global user.email "actions@github.com"
            git config --global user.name "GitHub Actions"
            git commit -m "Random commit $i at $(date)"
            sleep $((RANDOM % 3600))
          done
          git push

